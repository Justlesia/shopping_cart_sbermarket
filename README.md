# Соревнование на Kaggle для SberMarket. Следующий заказ пользователя.

## Описание

Необходимо построить модель, которая, может угадать, что пользователь захочет заказать в следующий раз.

Заказ пользователя состоит из списка уникальных категорий товаров, вне зависимости от того, сколько продуктов каждой категории он взял.
В качестве тренировочных данных представляется датасет с историей заказов 20000 пользователей вплоть до даты отсечки, которая разделяет тренировочные и тестовые данные по времени.

В качестве прогноза необходимо для каждой пары пользователь-категория из примера сабмита вернуть 1, если категория будет присутствовать в следующем заказе пользователя, или 0 в ином случае. Список категорий для каждого пользователя - это все категории, которые он когда-либо заказывал.

Оценка  по метрике F1-Score.

[Ссылка на соревнование](https://www.kaggle.com/c/sbermarket-internship-competition/)

## Результат

* *** Подход к решению брал за идею*** [TIFU-KNN](https://docviewer.yandex.ru/view/325118343/?page=1&*=VglfYk6qLBS6PyxwoRL9OFaESVF7InVybCI6Imh0dHBzOi8vYXJ4aXYub3JnL3BkZi8yMDA2LjAwNTU2LnBkZiIsInRpdGxlIjoiMjAwNi4wMDU1Ni5wZGYiLCJub2lmcmFtZSI6dHJ1ZSwidWlkIjoiMzI1MTE4MzQzIiwidHMiOjE2MzE2NDcxNzcyMzcsInl1IjoiNzE0NzU2OTEyMTYxMDYzNjI0MyIsInNlcnBQYXJhbXMiOiJ0bT0xNjMxNjQ2ODcwJnRsZD1ydSZsYW5nPWVuJm5hbWU9MjAwNi4wMDU1Ni5wZGYmdGV4dD10aWZ1K2tubiZ1cmw9aHR0cHMlM0EvL2FyeGl2Lm9yZy9wZGYvMjAwNi4wMDU1Ni5wZGYmbHI9MjEzJm1pbWU9cGRmJmwxMG49cnUmc2lnbj02MmU4MTFhZTFkMDZjMDBmMTk1ZWJlYWVjZDQwZGZiMSZrZXlubz0wIn0=&lang=en)
    * Был составлен профиль каждого покупателя. Одна строчка - весь его опыт покупок.
    * Произведен подсчет сколько раз покупались каждый из товаров.
    * Покупки одного пользователя ранжировались от более поздних к  более ранним. На каждом этапе данные взвешиваись на  "коэффициент забывания".
    * Далее находились ближайшие соседи (по близости векторов) и на основании рейтинга покупок клиента и его ближайших соседей (к ним применен весовой коэффициент на основании дальности) и был составлен список вероятных товаров для покупки.
    * При  выборе количества товаров за основу последнее количество купленных товаров в корзине.

***Данный подход показал хорошие результаты (0.44 на тестовой выборке).
В дальнейшем возможно улучшение показателей за счет подбора весовых коэффициентов "забывания", количества соседей  и их веса при подсчете финального рейтинга.***
